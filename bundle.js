!function t(i,e,n){function s(o,a){if(!e[o]){if(!i[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(r)return r(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=e[o]={exports:{}};i[o][0].call(c.exports,function(t){var e=i[o][1][t];return s(e?e:t)},c,c.exports,t,i,e,n)}return e[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t){var i=t("./playground");window.onload=function(){new i(document.getElementById("playground"))}},{"./playground":4}],2:[function(t,i){function e(){}e.extend=function(t){var i=this,e=t.hasOwnProperty("constructor")?t.constructor:function(){i.apply(this,arguments),t.initialize&&t.initialize.apply(this,arguments)};e.prototype=Object.create(i.prototype);for(var n in t)e.prototype[n]=t[n];return e.prototype.constructor=e,e.extend=i.extend,e},i.exports=e},{}],3:[function(t,i){function e(t,i){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))}var n=t("../class"),s=n.extend({initialize:function(t,i){i=i||{},this.dragging=null,this.points=t,this.threshold=i.threshold||20},start:function(t,i){var n={x:t,y:i},s=this.threshold,r=this.points.reduce(function(t,i){var r=e(n,i);return!t&&s>r?i:t&&e(t,n)>r?i:t},null);r&&(this.dragging=r)},move:function(t,i){this.dragging&&(this.dragging.x=t,this.dragging.y=i,this.points.emit("change"))},end:function(){this.dragging=null}});i.exports=s},{"../class":2}],4:[function(t,i){function e(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1}var n=t("./class"),s=t("./spline/dzhugashvili"),r=t("./spline/catmull-rom"),o=t("./renderer/per-segment-outline"),a=t("./renderer/knot"),h=t("./renderer/knot-vel"),c=t("./renderer/knot-acc"),l=t("./util/observable-array"),u=t("./control/drag-point"),p=t("./util/mouse"),f=n.extend({initialize:function(t){this.ctx=t.getContext("2d");var i=t.getBoundingClientRect();this.ctx.translate(-i.left,-i.top);var n=t.ownerDocument;n.addEventListener("contextmenu",e),this.points=new l;var f=new u(this.points);t.addEventListener("click",p(0,this.add,this)),t.addEventListener("mousedown",p(2,f.start,f)),t.addEventListener("mouseup",p(2,f.end,f)),t.addEventListener("mousemove",p(2,f.move,f)),this.loop=this.loop.bind(this),this.splines=[new s(this.points),new r(this.points)],this.renderers=[],this.renderers.push(new o(this.ctx)),this.renderers.push(new a(this.ctx)),this.renderers.push(new h(this.ctx)),this.renderers.push(new c(this.ctx)),this.loop()},loop:function(){this.draw(),window.requestAnimationFrame(this.loop)},add:function(t,i){this.points.push({x:t,y:i,t:Date.now()}),this.splines.forEach(function(t){t.recompile()})},draw:function(){this.points.length<2||(this.ctx.clearRect(0,0,1e3,1e3),this.renderers.forEach(function(t){this.splines.forEach(function(i){t.draw(i)},this)},this))}});i.exports=f},{"./class":2,"./control/drag-point":3,"./renderer/knot":7,"./renderer/knot-acc":5,"./renderer/knot-vel":6,"./renderer/per-segment-outline":9,"./spline/catmull-rom":10,"./spline/dzhugashvili":12,"./util/mouse":16,"./util/observable-array":17}],5:[function(t,i){var e=t("./knot"),n=e.extend({initialize:function(t,i){i=i||{},this.strokeStyle=i.strokeStyle||"#060"},drawKnot:function(t,i){this.ctx.beginPath();var e=t.par(i),n=t.getCompiled("x"),s=t.getCompiled("y"),r=t.getCompiled("x",2),o=t.getCompiled("y",2);this.ctx.moveTo(n(e),s(e)),this.ctx.lineTo(n(e)+5e3*r(e),s(e)+5e3*o(e)),this.ctx.stroke()}});i.exports=n},{"./knot":7}],6:[function(t,i){var e=t("./knot"),n=e.extend({initialize:function(t,i){i=i||{},this.strokeStyle=i.strokeStyle||"#f00"},drawKnot:function(t,i){this.ctx.beginPath();var e=t.pos(i,"x"),n=t.pos(i,"y"),s=t.vel(i,"x"),r=t.vel(i,"y");this.ctx.moveTo(e,n),this.ctx.lineTo(e+100*s,n+100*r),this.ctx.stroke()}});i.exports=n},{"./knot":7}],7:[function(t,i){var e=t("../class"),n=e.extend({initialize:function(t,i){i=i||{},this.ctx=t,this.fillStyle=i.fillStyle||"#666",this.strokeStyle=i.strokeStyle||"#fff",this.lineWidth=i.lineWidth||1,this.radius=i.radius||3},draw:function(t){var i=this.ctx;i.save(),i.strokeStyle=this.strokeStyle,i.fillStyle=this.fillStyle,i.lineWidth=this.lineWidth;for(var e=0;e<t.points.length;e++)this.drawKnot(t,e);i.restore()},drawKnot:function(t,i){var e=this.ctx;e.beginPath(),e.arc(t.points[i].x,t.points[i].y,this.radius,0,2*Math.PI),e.fill(),e.stroke()}});i.exports=n},{"../class":2}],8:[function(t,i){var e=t("../class"),n=e.extend({initialize:function(t,i){i=i||{},this.ctx=t,this.strokeStyle=i.strokeStyle||"#222",this.lineWidth=i.lineWidth||1},draw:function(t){this.ctx.save(),this.ctx.strokeStyle=this.strokeStyle,this.lineWidth=this.lineWidth,this.ctx.beginPath(),this.drawSpline(t),this.ctx.stroke()}});i.exports=n},{"../class":2}],9:[function(t,i){var e=t("./outline"),n=e.extend({initialize:function(t,i){i=i||{},this.segments=i.segments||50},drawSpline:function(t){for(var i=this.ctx,e=0;e<t.points.length-1;e++)for(var n=0;n<this.segments;n++){var s=t.par(e)+n*(t.par(e+1)-t.par(e))/(this.segments-1),r=t.getCompiled("x"),o=t.getCompiled("y");i.lineTo(r(s),o(s))}}});i.exports=n},{"./outline":8}],10:[function(t,i){var e=t("./kochanek-bartels"),n=e.extend({constructor:function(t){e.call(this,t,{tension:0,bias:0,continuity:0})}});i.exports=n},{"./kochanek-bartels":13}],11:[function(t,i){var e=t("./spline"),n=e.extend({initialize:function(){this.degree=n.degree},coeff:function(t,i,e){var n=t,s=t+1,r=this.pos(n,e),o=this.pos(s,e),a=this.vel(n,e),h=this.vel(s,e,!0),c=this.par(n),l=this.par(s),u=l-c;switch(i){case 0:return r;case 1:return a;case 2:return 3*(o-r)/u/u-(h+2*a)/u;case 3:return 2*(r-o)/u/u/u+(h+a)/u/u}}});n.degree=3,i.exports=n},{"./spline":15}],12:[function(t,i){var e=t("./quartic"),n=e.extend({initialize:function(){this._accCache=[],this.points.on("change",function(){this._accCache=[]},this)},acc:function(t,i){return 0==t?0:this._accCache[t]&&void 0!=this._accCache[t][i]?this._accCache[t][i]:(this._accCache[t]=this._accCache[t]||{})[i]=this.evaluate(this.par(t),i,2,t-1)},vel:function(t,i){if(0==t||t==this.points.length-1)return 0;var e=this.pos(t-1,i),n=this.pos(t,i),s=this.pos(t+1,i),r=this.par(t-1,i),o=this.par(t,i),a=this.par(t+1,i);return((n-e)/(o-r)+(s-n)/(a-o))/2}});i.exports=n},{"./quartic":14}],13:[function(t,i){var e=t("./cubic"),n=e.extend({initialize:function(t,i){this.tension=i.tension,this.bias=i.bias,this.continuity=i.continuity},vel:function(t,i,e){if(0==t||t==this.points.length-1)return 0;var n=this.pos(t-1,i),s=this.pos(t,i),r=this.pos(t+1,i),o=this.par(t-1,i),a=this.par(t,i),h=this.par(t+1,i),c=this.tension,l=this.bias,u=this.continuity;return(1-c)*(1+l)*(1+(e?-u:u))*(s-n)/(a-o)/2+(1-c)*(1-l)*(1+(e?u:-u))*(r-s)/(h-a)/2}});i.exports=n},{"./cubic":11}],14:[function(t,i){var e=t("./spline"),n=e.extend({initialize:function(){this.degree=n.degree},coeff:function(t,i,e){var n=t,s=t+1,r=this.pos(n,e),o=this.pos(s,e),a=this.vel(n,e),h=this.vel(s,e,!0),c=this.acc(n,e),l=this.par(n),u=this.par(s),p=u-l;switch(i){case 0:return r;case 1:return a;case 2:return c/2;case 3:return 4*(o-r)/p/p/p-(h+3*a)/p/p-c/p;case 4:return 3*(r-o)/p/p/p/p+(h+2*a)/p/p/p+c/2/p/p}}});n.degree=4,i.exports=n},{"./spline":15}],15:[function(t,i){function e(t,i){return Array(t-i+1).join(0).split(0).map(function(i,e){return t-e})}function n(t,i){return i?t*n(t-1,i-1):1}var s=t("../class"),r=s.extend({initialize:function(t){this.points=t,this.points.on("change",this.recompile,this)},pos:function(t,i){return this.points[t][i]},par:function(t){return this.points[t].t},seg:function(t){for(var i=0;i<this.points.length;i++)if(this.points[i].t>t)return i-1;return this.points.length-2},compile:function(t,i){return i=i||0,new Function("t",this.points.slice(0,this.points.length-1).map(function(s,r){return"if(t <= "+this.points[r+1].t+") return "+e(this.degree,i).map(function(e){return n(e,i)*this.coeff(r,e,t)+"*Math.pow(t - "+s.t+", "+(e-i)+")"},this).join(" + ")+";"},this).join("\n"))},evaluate:function(t,i,e,s){e=e||0,s=void 0==s?this.seg(t):s;for(var r=0,o=this.par(s),a=this.degree;a>=e;a--)r+=n(a,e)*this.coeff(s,a,i)*Math.pow(t-o,a-e);return r},compileLaTeX:function(t,i){return i=i||0,"f"+Array(i+1).join("'")+"_"+t+"(t)=\\left\\{\\begin{matrix}\n"+this.points.slice(0,this.points.length-1).map(function(n,s){var r=n.t-this.par(0);return e(this.degree,i).map(function(i){return this.coeff(s,i,t).toFixed(2)+(i?"(t-"+r.toFixed(2)+")"+(i>1?"^"+i:""):"")},this).join("+")+"&\\text{if}&"+r.toFixed(2)+"\\leq t<"+(this.par(s+1)-this.par(0)).toFixed(2)},this).join("\\\\\n")+"\n\\end{matrix}\\right."},getCompiled:function(t,i){return i=i||0,this.compiled&&this.compiled[i]&&this.compiled[i][t]||(this.compiled=this.compiled||[],this.compiled[i]=this.compiled[i]||{},this.compiled[i][t]=this.compile(t,i)),this.compiled[i][t]},draw:function(t,i){i=i||{},i.derivatives=i.derivatives||["#222"],i.details=i.details||20;var e=this.points,n=e.length;if(this.compiled||this.recompile(),i.derivatives[0]){t.strokeStyle=i.derivatives[0],t.beginPath();for(var s=0;n-1>s;s++)for(var r=0;r<i.details;r++){var o=e[s].t+(e[s+1].t-e[s].t)/(i.details-1)*r,a=this.compiled[0],h=a.x(o),c=a.y(o);t.lineTo(h,c)}t.stroke()}},recompile:function(){this.compiled=[0,1,2].map(function(t){return{x:this.compile("x",t),y:this.compile("y",t)}},this)}});i.exports=r},{"../class":2}],16:[function(t,i){i.exports=function(t,i,e){return function(n){if(n.button==t){var s=n.pageX,r=n.pageY;i.call(e,s,r)}}}},{}],17:[function(t,i){function e(t){Array.apply(this,t),Object.defineProperty(this,"_listeners",{value:[]})}e.prototype=Object.create(Array.prototype),e.prototype.constructor=e,e.prototype.on=function(t,i,e){this._listeners.push({label:t,fn:i,ctx:e})},e.prototype.emit=function(t){this._listeners.filter(function(i){return i.label==t}).forEach(function(t){t.fn.call(t.ctx)})},i.exports=e},{}]},{},[1]);